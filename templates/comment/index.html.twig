{% extends 'base.html.twig' %}

{% block title %}All Comments{% endblock %}

{% block body %}
    <div class="col-md-8 offset-md-2">
        <h2 class="mb-3">All Comments</h2>
        <ul class="list-group">
        {% for comment in comments %}
            <li class="list-group-item d-flex justify-content-between align-items-center py-1">
                <div class="pe-2">
                    <a href="{{ path('app_post_show', {id: comment.post.id}) }}" class="fw-semibold text-decoration-none">{{ comment.post.title }}</a>
                    <div class="small text-muted">{{ comment.user.email }} said: “{{ comment.content|length > 50 ? comment.content[:50] ~ '…' : comment.content }}”
                    </div>
                </div>
            {% if app.user and comment.user.id == app.user.id %}
                <div class="d-inline-flex align-items-center">
                    <a href="{{ path('comment_edit', {id: comment.id}) }}" class="btn btn-outline-secondary btn-sm me-1">Edit</a>
                    <form action="{{ path('comment_delete', {id: comment.id}) }}" method="post" onsubmit="return confirm('Delete this comment?');">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ comment.id) }}">
                        <button type="submit" class="btn btn-outline-danger btn-sm">Delete</button>
                    </form>
                </div>
            {% endif %}
            </li>
        {% else %}
            <li class="list-group-item text-center text-muted py-2">No comments found.</li>
        {% endfor %}
        </ul>
        <a href="{{ path('app_post_index') }}" class="btn btn-link mt-3 ps-0">Back to Posts</a>
    </div>
{% endblock %}
